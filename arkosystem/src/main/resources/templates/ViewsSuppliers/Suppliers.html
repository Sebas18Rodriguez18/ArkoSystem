<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/base}">
<head>
  <title>Proveedores - ArkoSystem</title>
</head>
<body>
<div layout:fragment="content">
  <div class="content-wrapper">
    <!-- Notificaciones -->
    <div th:if="${success}" class="alert alert-success alert-dismissible fade show" role="alert">
      <strong>¡Éxito!</strong> <span th:text="${success}"></span>
      <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>

    <div th:if="${error}" class="alert alert-danger alert-dismissible fade show" role="alert">
      <strong>Error:</strong> <span th:text="${error}"></span>
      <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>

    <!-- Encabezado -->
    <div class="mb-4">
      <h1 class="fw-bold" style="color: black;">Proveedores</h1>
      <div class="mt-2">
        <!-- Botón Añadir Proveedor con icono -->
        <a th:href="@{/view/suppliers/form}" class="btn btn-custom-warning">
          <i class="fas fa-plus me-1"></i> Añadir Proveedor
        </a>
      </div>
    </div>

    <!-- Buscador -->
    <div class="mb-3">
      <form method="get" action="/view/suppliers">
        <input type="text" id="searchInput" name="search" class="form-control" placeholder="Buscar por nombre..." th:value="${search}">
      </form>
    </div>

    <!-- Tabla de proveedores -->
    <div id="suppliersTable" class="custom-table-container">
      <!-- Cabecera -->
      <div class="row custom-table-header m-0">
        <div class="col text-center">ID</div>
        <div class="col text-center">Nombre</div>
        <div class="col text-center">Teléfono</div>
        <div class="col text-center">Dirección</div>
        <div class="col text-center">Email</div>
        <div class="col text-center">Acciones</div>
      </div>

      <!-- Filas -->
      <div th:each="supplier : ${suppliers}" class="row custom-table-row m-0 align-items-center">
        <div class="col text-center" th:text="${supplier.id}"></div>
        <div class="col text-center client-name" th:text="${supplier.name}"></div>
        <div class="col text-center" th:text="${supplier.phone}"></div>
        <div class="col text-center" th:text="${supplier.address}"></div>
        <div class="col text-center" th:text="${supplier.email}"></div>
        <div class="col text-center">
          <!-- Botón Editar con icono -->
          <a th:href="@{/view/suppliers/edit/{id}(id=${supplier.id})}"
             class="btn btn-sm btn-success me-1">
            <i class="fas fa-edit"></i>
          </a>
          <!-- Botón Eliminar con icono -->
          <form th:action="@{/view/suppliers/delete/{id}(id=${supplier.id})}"
                method="post"
                style="display:inline;"
                onsubmit="return confirm('¿Estás seguro de eliminar este proveedor?');">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" th:if="${_csrf != null}"/>
            <button type="submit" class="btn btn-sm btn-warning" title="Eliminar">
              <i class="fas fa-trash-alt"></i>
            </button>
          </form>
        </div>
      </div>

      <!-- Mensaje vacío -->
      <div th:if="${#lists.isEmpty(suppliers)}" class="row m-0">
        <div class="col text-center py-3 text-muted">
          <em>No hay proveedores registrados.</em>
        </div>
      </div>
    </div>
  </div>
</div>
</body>
</html>
